<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2026è¡†é™¢é¸ æ”¿ç­–ç†±åŠ›å­¦ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>

<!-- Chart.js & Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<style>
    body { background-color: #f0f2f5; font-family: "Helvetica Neue", Arial, sans-serif; }
    .header-area { background: #1a237e; color: white; padding: 20px 0; margin-bottom: 25px; border-bottom: 4px solid #f1c40f; }
    .simulator-card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); margin-bottom: 20px; transition: transform 0.2s; }
    .result-box { background: #e8f5e9; color: #2e7d32; padding: 20px; border-radius: 8px; margin-top: 15px; border-left: 5px solid #2ecc71; }
    .param-label { font-weight: bold; color: #444; font-size: 0.95rem; }
    #plot-area { width: 100%; min-height: 350px; }
    .btn-about { border: 1px solid white; color: white; font-size: 0.85rem; }
    .party-tag { font-size: 0.8em; padding: 3px 8px; border-radius: 4px; color: white; margin-right: 5px; display: inline-block; }
    
    /* æ”¿å…šã‚«ãƒ©ãƒ¼ */
    .bg-jimin { background-color: #d32f2f; } /* è‡ªæ°‘ãƒ»ç¶­æ–° */
    .bg-rikken { background-color: #1976d2; } /* ä¸­é“æ”¹é© */
    .bg-kokumin { background-color: #fbc02d; color: black; } /* å›½æ°‘æ°‘ä¸» */
    .bg-mirai { background-color: #8e44ad; } /* ãƒãƒ¼ãƒ ã¿ã‚‰ã„ */
    .bg-kyosan { background-color: #880e4f; } /* å…±ç”£ãƒ»ã‚Œã„ã‚ */
</style>
</head>
<body>

<!-- Header -->
<div class="header-area">
    <div class="container d-flex justify-content-between align-items-center">
        <div>
            <h4 class="m-0 fw-bold">ğŸ—³ï¸ 2026è¡†é™¢é¸ æ”¿ç­–ç†±åŠ›å­¦ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h4>
            <small class="opacity-75">ç‰©ç†æ³•å‰‡ã§æœªæ¥ã‚’äºˆæ¸¬ã™ã‚‹</small>
        </div>
        <button class="btn btn-sm btn-about" data-bs-toggle="modal" data-bs-target="#aboutModal">
            â“˜ è§£èª¬
        </button>
    </div>
</div>

<div class="container">
    <div class="row">
        <!-- Input Panel -->
        <div class="col-lg-5 mb-3">
            <div class="simulator-card">
                <h6 class="mb-4 border-bottom pb-2 fw-bold">ğŸ›ï¸ ã‚ãªãŸãŒæœ›ã‚€æ—¥æœ¬ã®è¨­è¨ˆå›³</h6>
                
                <!-- æ¶ˆè²»ç¨ -->
                <div class="mb-4">
                    <label class="param-label">æ¶ˆè²»ç¨ç‡</label>
                    <input type="range" class="form-range" id="tax_rate" min="0" max="15" value="10" step="1" oninput="updateVal('val_tax', this.value, '%')">
                    <div class="d-flex justify-content-between small text-muted">
                        <span>å»ƒæ­¢ (0%)</span>
                        <span id="val_tax" class="fw-bold text-primary fs-5">10%</span>
                        <span>å¢—ç¨ (15%)</span>
                    </div>
                </div>

                <!-- è²¡æ”¿å‡ºå‹• -->
                <div class="mb-4">
                    <label class="param-label">è²¡æ”¿å‡ºå‹•ã®è¦æ¨¡ã¨è³ª</label>
                    <input type="range" class="form-range" id="fiscal_spend" min="0" max="3" value="1" step="1" oninput="updateFiscalLabel(this.value)">
                    <div class="d-flex justify-content-between small text-muted">
                        <span>ç·Šç¸®ãƒ»ç¶­æŒ</span>
                        <span id="val_fiscal" class="fw-bold text-primary">ç¾çŠ¶ç¶­æŒ</span>
                        <span>è¶…ç©æ¥µ</span>
                    </div>
                    <small id="fiscal_desc" class="d-block mt-1 text-secondary" style="font-size:0.8em">ãƒãƒ©ãƒ³ã‚¹é‡è¦–ã®äºˆç®—é…åˆ†</small>
                </div>

                <!-- ç¤¾ä¼šä¿éšœãƒ»å£ -->
                <div class="mb-4">
                    <label class="param-label">ç¤¾ä¼šä¿éšœã¨ã€Œå¹´åã®å£ã€</label>
                    <select class="form-select form-select-sm" id="social_wall">
                        <option value="keep">ç¾çŠ¶ç¶­æŒ (103ä¸‡å††ã®å£ã‚ã‚Š)</option>
                        <option value="reform_mid">çµ¦ä»˜ä»˜ãç¨é¡æ§é™¤ (ä½æ‰€å¾—è€…æ”¯æ´)</option>
                        <option value="reform_high">å£ã®æ’¤å»ƒ (åŸºç¤æ§é™¤178ä¸‡å††ã¸)</option>
                        <option value="system_opt">ã‚·ã‚¹ãƒ†ãƒ æœ€é©åŒ– (ãªã‚ã‚‰ã‹ãªè² æ‹…å¢—)</option>
                    </select>
                </div>

                <!-- é˜²è¡›ãƒ»å¤–äº¤ -->
                <div class="mb-4">
                    <label class="param-label">é˜²è¡›ãƒ»å¤–äº¤ã‚¹ã‚¿ãƒ³ã‚¹</label>
                    <div class="btn-group w-100" role="group">
                        <input type="radio" class="btn-check" name="defense" id="def_peace" value="peace">
                        <label class="btn btn-outline-secondary btn-sm" for="def_peace">å¯¾è©±ãƒ»è»ç¸®</label>

                        <input type="radio" class="btn-check" name="defense" id="def_status" value="status" checked>
                        <label class="btn btn-outline-secondary btn-sm" for="def_status">å°‚å®ˆé˜²è¡›</label>

                        <input type="radio" class="btn-check" name="defense" id="def_strong" value="strong">
                        <label class="btn btn-outline-secondary btn-sm" for="def_strong">é˜²è¡›åŠ›å¼·åŒ–</label>
                    </div>
                </div>

                <!-- ã‚¨ãƒãƒ«ã‚®ãƒ¼ -->
                <div class="mb-4">
                    <label class="param-label">ã‚¨ãƒãƒ«ã‚®ãƒ¼æ”¿ç­–</label>
                    <div class="btn-group w-100" role="group">
                        <input type="radio" class="btn-check" name="energy" id="ene_renew" value="renew">
                        <label class="btn btn-outline-secondary btn-sm" for="ene_renew">å†ã‚¨ãƒ/è„±åŸç™º</label>

                        <input type="radio" class="btn-check" name="energy" id="ene_mix" value="mix" checked>
                        <label class="btn btn-outline-secondary btn-sm" for="ene_mix">ç¾å®Ÿè·¯ç·š(åŸç™º)</label>
                        
                        <input type="radio" class="btn-check" name="energy" id="ene_tech" value="tech">
                        <label class="btn btn-outline-secondary btn-sm" for="ene_tech">æŠ€è¡“æŠ•è³‡(æ ¸èåˆç­‰)</label>
                    </div>
                </div>

                <button onclick="runSimulation()" class="btn btn-primary w-100 fw-bold shadow-sm py-2">
                    ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ ğŸš€
                </button>
            </div>
        </div>

        <!-- Result Panel -->
        <div class="col-lg-7">
            <div class="simulator-card">
                <h6 class="mb-3 border-bottom pb-2 fw-bold">ğŸ“Š 5å¹´å¾Œã®æ—¥æœ¬çµŒæ¸ˆäºˆæ¸¬ (SBCMåˆ†æ)</h6>
                <div id="chart-container" style="position: relative; height:300px;">
                    <canvas id="resultChart"></canvas>
                </div>
                
                <div id="result-text" class="result-box">
                    <strong>ğŸ‘ˆ å·¦ã®ãƒ‘ãƒãƒ«ã§æ”¿ç­–ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</strong><br>
                    ã‚ãªãŸã®é¸æŠãŒã©ã®æ”¿å…šã®å…¬ç´„ã«è¿‘ã„ã‹ã€ãã—ã¦ãã‚ŒãŒç‰©ç†çš„ï¼ˆç†±åŠ›å­¦çš„ï¼‰ã«æ—¥æœ¬çµŒæ¸ˆã«ã©ã®ã‚ˆã†ãªå½±éŸ¿ã‚’ä¸ãˆã‚‹ã‹ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
                </div>
                
                <div class="mt-3 text-end">
                     <a id="twitter-share" href="#" target="_blank" class="btn btn-sm btn-dark disabled">
                        Twitterã§çµæœã‚’ã‚·ã‚§ã‚¢
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- About Modal -->
<div class="modal fade" id="aboutModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">SBCMç†è«–ã«ã¤ã„ã¦</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body small">
                <p>ã“ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã¯ã€<strong>ã€ŒSBCMï¼ˆæ¨™æº–ãƒ–ãƒ­ãƒƒã‚¯æ¯”è¼ƒæ³•ï¼‰ã€</strong>ã¨ã„ã†çµ±æ²»å·¥å­¦ç†è«–ã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‚</p>
                <p>æ”¿ç­–ã‚’ã€Œæ€æƒ³ã€ã§ã¯ãªãã€ä»¥ä¸‹ã®ç‰©ç†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦æ‰±ã„ã¾ã™ã€‚</p>
                <ul>
                    <li><strong>å…¥åŠ› (Input):</strong> äºˆç®—ã‚„ç¨åˆ¶ï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼æ³¨å…¥ï¼‰</li>
                    <li><strong>åŠ¹ç‡ (Efficiency):</strong> ã‚·ã‚¹ãƒ†ãƒ ã®æ­ªã¿ã‚„ä¸­æŠœãï¼ˆç†±æå¤±ï¼‰</li>
                    <li><strong>å‡ºåŠ› (Output):</strong> å®Ÿè³ªæ‰‹å–ã‚Šã‚„ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ï¼ˆä»•äº‹é‡ï¼‰</li>
                </ul>
                <p>ã€Œèã“ãˆã®è‰¯ã„æ”¿ç­–ã€ãŒå¿…ãšã—ã‚‚ã€Œè‰¯ã„çµæœã€ã‚’ç”Ÿã¾ãªã„ã“ã¨ã‚’ã€ç‰©ç†æ³•å‰‡ï¼ˆç—›ã¿ã®ä¿å­˜å‰‡ã€æ¼å‡ºã®å®šç†ï¼‰ã‚’ç”¨ã„ã¦å¯è¦–åŒ–ã—ã¾ã™ã€‚</p>
                <a href="https://github.com/SBCM-Alliance" target="_blank">GitHub: SBCM-Alliance</a>
            </div>
        </div>
    </div>
</div>

<script>
    let myChart = null;

    function updateVal(id, val, suffix) {
        document.getElementById(id).innerText = val + suffix;
    }

    function updateFiscalLabel(val) {
        const labels = ["ç·Šç¸®ãƒ»ç¶­æŒ", "ãƒãƒ©ãƒ³ã‚¹å‹", "ç©æ¥µè²¡æ”¿", "ç•°æ¬¡å…ƒç·©å’Œ"];
        const descs = [
            "ç¾çŠ¶ç¶­æŒã€‚è²¡æ”¿è¦å¾‹ã‚’é‡è¦–ã€‚",
            "å¿…è¦ãªåˆ†é‡ã«çµã£ã¦æŠ•è³‡ã€‚",
            "å›½å‚µç™ºè¡Œã§æˆé•·åˆ†é‡ã¸æŠ•è³‡ã€‚",
            "çµ¦ä»˜é‡‘ã‚„å…¬å…±äº‹æ¥­ã‚’å¤§é‡æŠ•å…¥ã€‚"
        ];
        document.getElementById("val_fiscal").innerText = labels[val];
        document.getElementById("fiscal_desc").innerText = descs[val];
    }

    function runSimulation() {
        // 1. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾—
        const taxRate = parseFloat(document.getElementById("tax_rate").value);
        const fiscalLvl = parseInt(document.getElementById("fiscal_spend").value); // 0-3
        const socialWall = document.getElementById("social_wall").value;
        const defense = document.querySelector('input[name="defense"]:checked').value;
        const energy = document.querySelector('input[name="energy"]:checked').value;

        // 2. ç‰©ç†è¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³ (SBCM Logic)
        // åŸºæº–å€¤ (2025å¹´æƒ³å®š)
        const baseIncome = 460; // ä¸‡å††
        const baseInflation = 1.5; // %
        
        let incomeScore = 0; // æ‰‹å–ã‚Šå¤‰åŒ–
        let inflationScore = 0; // ã‚¤ãƒ³ãƒ•ãƒ¬åœ§åŠ›
        let distortionScore = 1.0; // è¡Œæ”¿ã®æ­ªã¿ï¼ˆ1.0ãŒåŸºæº–ã€é«˜ã„ã»ã©ç„¡é§„ãŒå¤šã„ï¼‰
        let futureBurden = 0; // å°†æ¥ä¸–ä»£ã¸ã®ãƒ„ã‚±

        // A. ç¨åˆ¶ã®å½±éŸ¿ (ç—›ã¿ã®ä¿å­˜å‰‡)
        // æ¶ˆè²»ç¨æ¸›ç¨ã¯æ‰‹å–ã‚Šå¢—ã ãŒã€è²¡æºä¸è¶³ãªã‚‰å°†æ¥è² æ‹…å¢—ã‹ã‚¤ãƒ³ãƒ•ãƒ¬
        incomeScore += (10 - taxRate) * 1.5;
        if (taxRate < 5) {
            futureBurden += (5 - taxRate) * 10; // éåº¦ãªæ¸›ç¨ã¯å°†æ¥è² æ‹…å¢—
            inflationScore += (5 - taxRate) * 0.2; // å††å®‰ãƒ»ã‚¤ãƒ³ãƒ•ãƒ¬åœ§åŠ›
        }

        // B. è²¡æ”¿å‡ºå‹•ã®å½±éŸ¿ (æ¼å‡ºã®å®šç†)
        // é©åˆ‡ãªæŠ•è³‡ã¯æˆé•·ã‚’ç”Ÿã‚€ãŒã€éå‰°ãªãƒãƒ©ãƒã‚­ã¯æ­ªã¿(ä¸­æŠœã)ã¨ã‚¤ãƒ³ãƒ•ãƒ¬ã‚’ç”Ÿã‚€
        if (fiscalLvl === 0) { // ç·Šç¸®
            incomeScore -= 5;
            inflationScore -= 0.5;
        } else if (fiscalLvl === 1) { // ãƒãƒ©ãƒ³ã‚¹
            incomeScore += 5;
        } else if (fiscalLvl === 2) { // ç©æ¥µ (æŠ•è³‡)
            incomeScore += 15;
            inflationScore += 0.5;
            distortionScore += 0.1; // å°‘ã—æ­ªã‚€
        } else if (fiscalLvl === 3) { // ç•°æ¬¡å…ƒ (ãƒãƒ©ãƒã‚­)
            incomeScore += 20; // ä¸€æ™‚çš„ã«ã¯å¢—ãˆã‚‹
            inflationScore += 3.0; // æ‚ªæ€§ã‚¤ãƒ³ãƒ•ãƒ¬
            distortionScore += 0.5; // æ¿€ã—ã„ä¸­æŠœããƒ»æ¼å‡º
            futureBurden += 50;
        }

        // C. ç¤¾ä¼šä¿éšœãƒ»å£ã®å½±éŸ¿
        if (socialWall === 'reform_high') { // 178ä¸‡å††ã®å£ (å›½æ°‘æ°‘ä¸»)
            incomeScore += 25; // æ‰‹å–ã‚Šæ¿€å¢—
            futureBurden += 20; // è²¡æºå¿…è¦
        } else if (socialWall === 'system_opt') { // ã‚·ã‚¹ãƒ†ãƒ æœ€é©åŒ– (ãƒãƒ¼ãƒ ã¿ã‚‰ã„)
            incomeScore += 15; // æ‰‹å–ã‚Šå¢—
            distortionScore -= 0.3; // æ­ªã¿ãŒè§£æ¶ˆã•ã‚Œã‚‹ï¼ˆåŠ¹ç‡åŒ–ï¼‰
        } else if (socialWall === 'reform_mid') { // çµ¦ä»˜ä»˜ãç¨é¡æ§é™¤ (ä¸­é“)
            incomeScore += 10; // ä½æ‰€å¾—è€…ã«ã¯æ©æµ
            distortionScore += 0.1; // äº‹å‹™ã‚³ã‚¹ãƒˆå¢—
        }

        // D. ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ»é˜²è¡›ã®å½±éŸ¿
        if (energy === 'tech') { // æŠ€è¡“æŠ•è³‡ (ã¿ã‚‰ã„)
            futureBurden += 10; // å…ˆè¡ŒæŠ•è³‡
            // é•·æœŸçš„ã«ã¯ãƒ—ãƒ©ã‚¹ã ãŒ5å¹´ã§ã¯ã‚³ã‚¹ãƒˆ
        } else if (energy === 'renew' && taxRate < 5) { // å†ã‚¨ãƒ+æ¸›ç¨ (å…±ç”£ãƒ»ã‚Œã„ã‚)
            inflationScore += 2.0; // ã‚³ã‚¹ãƒˆãƒ—ãƒƒã‚·ãƒ¥ã‚¤ãƒ³ãƒ•ãƒ¬
        }

        // æœ€çµ‚è¨ˆç®—
        // æ­ªã¿ãŒå¤§ãã„ã¨ã€æ‰‹å–ã‚Šå¢—ã®åŠ¹æœãŒæ¸›æ®ºã•ã‚Œã‚‹ (æ¼å‡º)
        const finalIncome = baseIncome + (incomeScore / distortionScore) - (inflationScore * 5);
        const finalInflation = baseInflation + inflationScore;
        const finalDistortion = distortionScore;

        // 3. æ”¿å…šãƒãƒƒãƒãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯ (é‡ã¿ä»˜ã‘è·é›¢è¨ˆç®—)
        // å„å…šã®ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ« [æ¶ˆè²»ç¨, è²¡æ”¿, å£å¯¾ç­–, é˜²è¡›, ã‚¨ãƒãƒ«ã‚®ãƒ¼]
        // â€»ç°¡æ˜“åŒ–ã®ãŸã‚ã€ifæ–‡ã§ç‰¹å¾´çš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡º

        let bestMatch = "è©²å½“ãªã—";
        let partyColor = "#7f8c8d";
        let partyDesc = "ç‹¬è‡ªã®æ”¿ç­–ãƒŸãƒƒã‚¯ã‚¹ã§ã™ã€‚";
        let matchScore = 0;

        // ğŸ”´ è‡ªæ°‘ãƒ»ç¶­æ–° (æ”¹æ†²ãƒ»æˆé•·ãƒ»åŸç™º)
        if (fiscalLvl >= 1 && defense === 'strong' && energy === 'mix') {
            bestMatch = "ğŸ”´ è‡ªæ°‘ãƒ»ç¶­æ–° é€£ç«‹æ”¿æ¨©";
            partyColor = "#d32f2f";
            partyDesc = "ã€Œå¼·ã„æ—¥æœ¬ã€ã‚’ç›®æŒ‡ã™å®‰å®šè·¯ç·šã€‚é˜²è¡›ãƒ»æˆé•·ç”£æ¥­ã¸ã®æŠ•è³‡ã‚’é‡è¦–ã—ã¾ã™ãŒã€æ ¼å·®æ‹¡å¤§ã®æ‡¸å¿µã‚‚ã€‚";
        }

        // ğŸŸ¡ å›½æ°‘æ°‘ä¸»å…š (æ‰‹å–ã‚Šå¢—ãƒ»178ä¸‡ãƒ»ç©æ¥µè²¡æ”¿)
        if (socialWall === 'reform_high' && fiscalLvl >= 2 && taxRate <= 5) {
            bestMatch = "ğŸŸ¡ å›½æ°‘æ°‘ä¸»å…š";
            partyColor = "#fbc02d";
            partyDesc = "ã€Œæ‰‹å–ã‚Šã‚’å¢—ã‚„ã™ã€ã“ã¨ã«ç‰¹åŒ–ã€‚ç¾å½¹ä¸–ä»£ã«ã¯æœ€å¼·ã§ã™ãŒã€è²¡æºè«–ã§ã®åç™ºãŒäºˆæƒ³ã•ã‚Œã¾ã™ã€‚";
        }
        // æ¡ä»¶ç·©å’Œç‰ˆï¼ˆæ¶ˆè²»ç¨10%ã§ã‚‚å£æ’¤å»ƒãªã‚‰ï¼‰
        else if (socialWall === 'reform_high') {
             bestMatch = "ğŸŸ¡ å›½æ°‘æ°‘ä¸»å…š (ç¾å®Ÿè·¯ç·š)";
             partyColor = "#fbc02d";
             partyDesc = "å£æ’¤å»ƒã‚’æœ€å„ªå…ˆã—ã¤ã¤ã€æ¶ˆè²»ç¨ã¯æ®ãˆç½®ãç¾å®Ÿçš„ãªå›½æ°‘æ°‘ä¸»å…šè·¯ç·šã§ã™ã€‚";
        }

        // ğŸš€ ãƒãƒ¼ãƒ ã¿ã‚‰ã„ (ã‚·ã‚¹ãƒ†ãƒ æœ€é©åŒ–ãƒ»æŠ•è³‡ãƒ»æŠ€è¡“)
        if (socialWall === 'system_opt' && energy === 'tech') {
            bestMatch = "ğŸš€ ãƒãƒ¼ãƒ ã¿ã‚‰ã„";
            partyColor = "#8e44ad";
            partyDesc = "ã€Œä»•çµ„ã¿ã‚’å¤‰ãˆã‚‹ã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°çš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã€‚æ´¾æ‰‹ã•ã¯ãªã„ãŒã€è¡Œæ”¿ã®ãƒ ãƒ€ï¼ˆæ­ªã¿ï¼‰ã‚’æœ€å°åŒ–ã—ã€æœ€ã‚‚åŠ¹ç‡ã‚ˆãæ‰‹å–ã‚Šã‚’å¢—ã‚„ã—ã¾ã™ã€‚";
        }

        // ğŸ”µ ä¸­é“æ”¹é©é€£åˆ (ç«‹æ†²ãƒ»å…¬æ˜) (çµ¦ä»˜ãƒ»å†ã‚¨ãƒãƒ»å¯¾è©±)
        if (socialWall === 'reform_mid' && defense === 'peace') {
            bestMatch = "ğŸ”µ ä¸­é“æ”¹é©é€£åˆ (ç«‹æ†²ãƒ»å…¬æ˜)";
            partyColor = "#1976d2";
            partyDesc = "åˆ†é…ã¨ç¦ç¥‰ã‚’é‡è¦–ã€‚ã€Œäººã¸ã®æŠ•è³‡ã€ã‚’æ²ã’ã¾ã™ãŒã€ç¾å½¹ä¸–ä»£ã®è² æ‹…æ„Ÿã¯æ®‹ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚";
        }

        // ğŸŸ£ å…±ç”£ãƒ»ã‚Œã„ã‚ (æ¶ˆè²»ç¨å»ƒæ­¢ãƒ»åç·Šç¸®)
        if (taxRate === 0 && fiscalLvl === 3) {
            bestMatch = "ğŸŸ£ é‡å…šå…±é—˜ (å…±ç”£ãƒ»ã‚Œã„ã‚)";
            partyColor = "#880e4f";
            partyDesc = "æ¶ˆè²»ç¨å»ƒæ­¢ã¨å¾¹åº•çš„ãªè²¡æ”¿å‡ºå‹•ã€‚çŸ­æœŸçš„ã«ã¯æ¥½ã«ãªã‚Šã¾ã™ãŒã€SBCMç†è«–ä¸Šã¯ã€Œç†±çš„æ­»ï¼ˆãƒã‚¤ãƒ‘ãƒ¼ã‚¤ãƒ³ãƒ•ãƒ¬ï¼‰ã€ã®ãƒªã‚¹ã‚¯ãŒæœ€å¤§ã§ã™ã€‚";
        }

        // 4. ãƒãƒ£ãƒ¼ãƒˆæç”»
        const ctx = document.getElementById('resultChart').getContext('2d');
        if (myChart) myChart.destroy();

        // åŸºæº–(2025)ã¨ã®æ¯”è¼ƒ
        const dataIncome = Math.round(finalIncome);
        const dataInf = finalInflation.toFixed(1);
        const dataDist = finalDistortion.toFixed(2);

        myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['æ‰‹å–ã‚Š(å¹´å)', 'ã‚¤ãƒ³ãƒ•ãƒ¬ç‡', 'è¡Œæ”¿ã®ãƒ ãƒ€(æ­ªã¿)'],
                datasets: [{
                    label: 'äºˆæ¸¬å€¤',
                    data: [dataIncome/baseIncome*100, (dataInf/baseInflation)*100, dataDist*100],
                    backgroundColor: [
                        dataIncome >= baseIncome ? '#2ecc71' : '#e74c3c',
                        dataInf > 2.5 ? '#e74c3c' : '#3498db',
                        dataDist > 1.1 ? '#e74c3c' : '#3498db'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { 
                        beginAtZero: false, 
                        min: 50, max: 180,
                        grid: { color: '#f0f0f0' },
                        ticks: { display: false } // ç›®ç››ã‚Šæ•°å­—ã¯éš ã™
                    }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                let val = context.raw;
                                if(context.dataIndex===0) return `åŸºæº–æ¯”: ${Math.round(val)}%`;
                                return `æŒ‡æ•°: ${Math.round(val)}`;
                            }
                        }
                    }
                }
            }
        });

        // 5. çµæœè¡¨ç¤º
        const diff = Math.round(finalIncome - baseIncome);
        const sign = diff > 0 ? "+" : "";
        
        let html = `<h5 style="color:${partyColor}">${bestMatch}</h5>`;
        html += `<p class="small">${partyDesc}</p>`;
        html += `<hr>`;
        html += `<div class="row text-center">`;
        html += `<div class="col-4"><strong>æ‰‹å–ã‚Š</strong><br><span class="fs-5">${dataIncome}ä¸‡</span><br><small class="${diff>0?'text-success':'text-danger'}">(${sign}${diff})</small></div>`;
        html += `<div class="col-4"><strong>ã‚¤ãƒ³ãƒ•ãƒ¬</strong><br><span class="fs-5">${dataInf}%</span></div>`;
        html += `<div class="col-4"><strong>æ­ªã¿æŒ‡æ•°</strong><br><span class="fs-5">${dataDist}</span></div>`;
        html += `</div>`;

        // SBCMè­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        if(finalDistortion > 1.2) {
            html += `<div class="mt-3 p-2 bg-warning bg-opacity-25 rounded small text-dark">âš ï¸ <strong>SBCMè­¦å‘Š:</strong> ãƒãƒ©ãƒã‚­ã«ã‚ˆã‚Šã€Œæ­ªã¿ã€ãŒå¢—å¤§ã—ã¦ã„ã¾ã™ã€‚åœ°æ–¹ã¸ã®æŠ•è³‡åŠ¹ç‡ãŒæ‚ªåŒ–ã—ã€è³‡é‡‘ãŒæ¼å‡ºã—ã¦ã„ã¾ã™ã€‚</div>`;
        } else if (finalDistortion < 0.9) {
            html += `<div class="mt-3 p-2 bg-success bg-opacity-25 rounded small text-dark">âœ… <strong>SBCMè©•ä¾¡:</strong> ã‚·ã‚¹ãƒ†ãƒ æœ€é©åŒ–ã«ã‚ˆã‚Šã€Œæ­ªã¿ã€ãŒè§£æ¶ˆã•ã‚Œã¦ã„ã¾ã™ã€‚åŠ¹ç‡çš„ãªçµŒæ¸ˆå¾ªç’°ãŒæœŸå¾…ã§ãã¾ã™ã€‚</div>`;
        }

        document.getElementById("result-text").innerHTML = html;

        // Twitterãƒªãƒ³ã‚¯
        const tweetText = `ç§ã®æ”¿ç­–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœï¼š\nã€${bestMatch}ã€‘\nğŸ’°æ‰‹å–ã‚Šï¼š${dataIncome}ä¸‡å†† (${sign}${diff})\nğŸ“ˆã‚¤ãƒ³ãƒ•ãƒ¬ï¼š${dataInf}%\nğŸ¤–æ­ªã¿æŒ‡æ•°ï¼š${dataDist}\n\n#2026è¡†é™¢é¸ #SBCMã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼`;
        const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}`;
        const btn = document.getElementById("twitter-share");
        btn.href = url;
        btn.classList.remove("disabled", "btn-dark");
        btn.classList.add("btn-primary");
    }
</script>

</body>
</html>